<!DOCTYPE HTML>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-biTemplateInfo-add">
                                                                            <div class="form-group">
                        <label class="col-sm-3 control-label">模板编号：</label>
                        <div class="col-sm-8">
                            <input id="templateNo" name="templateNo" class="form-control" type="text">
                        </div>
                    </div>
                                                                                    <div class="form-group">
                    <label class="col-sm-3 control-label">汇报对象：</label>
                        <div class="col-sm-8">
                            <select id="senderIndexNo" name="senderIndexNo" class="form-control m-b"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">参考指标：</label>
                        <div class="col-sm-8">
                            <select id="exampleIndexNo" class="form-control m-b"></select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">可选参数：</label>
                        <div class="col-sm-8" id="paramStr">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">模板名称：</label>
                        <div class="col-sm-8">
                            <input id="templateName" name="templateName" class="form-control" type="text">
                        </div>
                    </div>
                                                                                    <div class="form-group">
                        <label class="col-sm-3 control-label">模板内容：</label>
                        <div class="col-sm-8">
                            <textarea id="templateContent" name="templateContent" class="form-control"   rows="15" cols="150"></textarea>
                        </div>
                    </div>

                                        </form>
</div>
<div th:include="include::footer"></div>
<script type="text/javascript">
    var prefix = ctx + "system/biTemplateInfo"
    $("#form-biTemplateInfo-add").validate({
        rules: {
            xxxx: {
                required: true,
            },
        },
        focusCleanup: true
    });

    function submitHandler() {
        if ($.validate.form()) {
            $.operate.save(prefix + "/add", $('#form-biTemplateInfo-add').serialize());
        }
    }

    $("#senderIndexNo").empty();
    var indexNo = null;
    $.get(ctx + "system/biIndexInfo/selectIndexDetailList", function (result) {
        var data = result;
        data = $.parseJSON(data);
        $.each(data, function (k, item) {
            $("#senderIndexNo").append("<option value='" + item.indexNo + "'>" + item.indexName + "</option>");
            if(indexNo==null)
            {
                indexNo = item.indexNo;
            }
        });

        $.post(ctx + "system/biIndexInfo/getIndexNoParamStr",{"indexNo":indexNo}, function (result) {
            var data = result;

            $("#paramStr").text(data);
        })
    });

    //范围属性联动
    $("#senderIndexNo").change(function ()
    {
        indexNo = $(this).children('option:selected').val();
        $.post(ctx + "system/biIndexInfo/getIndexNoParamStr",{"indexNo":indexNo}, function (result) {
            var data = result;
            $("#paramStr").text(data);
        })
    })


    $.get(ctx + "system/biIndexInfo/selectAllIndexList", function (result) {
        var data = result;
        data = $.parseJSON(data);
        $.each(data, function (k, item) {
            $("#exampleIndexNo").append("<option value='" + item.indexNo + "'>" + item.indexName + "</option>");
        });
    });

    //范围属性联动
    $("#exampleIndexNo").change(function ()
    {
        indexNo = $(this).children('option:selected').val();
        $.post(ctx + "system/biIndexInfo/getIndexNoParamByIndexNo",{"indexNo":indexNo}, function (result) {
            var data = result;
            $("#paramStr").text(data);
        })
    })




</script>
</body>
</html>
